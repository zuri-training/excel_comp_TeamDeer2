<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Excel Comp</title>
    <link rel="stylesheet" href="login.css" />
  </head>
  <body>
    <!-- This is a login page -->
    <div class="main-page">
      <div class="logo">
        <img src="images/Frame 19305.svg" alt="logo" />
      </div>

      <div class="main">
        <div class="left-side">
          <h2>Welcome back, <b>Login</b></h2>
          <div class="media-h3">
            <h3 class="login">Login</h3>
            <p>Welcome back, We've missed you</p>
          </div>

          <form
            id="login-form"
            action="./dashboard/dashboard.html"
            method="post"
          >
            <input
              type="email"
              name="email"
              id="email"
              placeholder="Enter Email Address"
              required
            /><br />

            <input
              type="password"
              name="password"
              id="password"
              placeholder="Password"
              required
            /><br />

            <a href="./Forgot Password/fp.html" target="_blank"
              ><p class="normal-p">Forgot Password?</p></a
            >
            <a href="./Forgot Password/fp.html" target="_blank"
              ><p class="media-p">Forgot Password?</p></a
            >
            <input class="btn-1" type="submit" value="Login" />
          </form>
          <div class="p-tags">
            <p>
              Don't have an account?
              <a href="./signuppage/signup.html" class="register-p">
                <span class="register1">Register</span></a
              >
            </p>
          </div>
        </div>
        <footer class="media-p1">
          <p>
            Don't have an account?
            <a href="./signuppage/signup.html" class="register-p"
              ><span class="register">Register</span></a
            >
          </p>
          <!-- <p>Don't have an account? <span class="register">Register</span></p> -->
        </footer>

        <div class="right-side">
          <div class="site-img">
            <img class="site" src="images/Rectangle 38.png" alt="site-image" />
          </div>
        </div>
      </div>
    </div>
  </body>

  <script>
    // Get a reference to the password field
    const passwordField = document.getElementById("password");

    // Listen for a click event on the password field
    passwordField.addEventListener("click", function () {
      // If the type of the password field is "password", change it to "text"
      if (passwordField.type === "password") {
        passwordField.type = "text";
      }
      // Otherwise, the type is "text" so change it to "password"
      else {
        passwordField.type = "password";
      }
    });

    // Get the login form
    const loginForm = document.getElementById("login-form");

    // Handle the form submission
    loginForm.addEventListener("submit", (e) => {
      // Prevent the default form submission behavior
      e.preventDefault();

      // Get the user's login credentials
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;

      // Send the login credentials to the backend
      fetch("http://localhost:3000/user/login", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ email, password }),
      })
        .then((response) => response.json())
        .then((data) => {
          // Handle the response from the backend

          if (data.status === 'SUCCESS') {
            // Login was successful
            alert("Login successful!");
            window.location.href = "./dashboard/dashboard.html";
          } else {
            // Login failed
            alert(`${data?.message || 'Login failed! Please try again'}`);
          }
        });
    });
  </script>
</html>
